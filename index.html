<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Lesson Plan</title>
    <style>
        * {
            box-sizing: border-box;
            user-select: none;
        }
        body {
            font-family: 'Syne', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .planner {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 1.5em;
        }
        .materials {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
        }
        .material {
            border-radius: 50px;
            padding: 10px 10px;
            margin-bottom: 5px;
            cursor: move;
            font-size: 1.1em;
            position: relative;
            touch-action: none;
        }
        .material .delete-btn {
            display: none;
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: red;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            line-height: 1;
        }
        .material:hover .delete-btn {
            display: block;
        }
        .grid {
            display: grid;
            grid-template-columns: auto repeat(7, 1fr);
            gap: 1px;
            flex-grow: 1;
        }
        .grid > div {
            background-color: white;
            padding: 5px;
            min-height: 40px;
            font-size: 0.8em;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .day {
            font-weight: bold;
            border-radius: 100px;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(180deg);
            background-color: #f9f9f9 !important;
        }
        .cell {
            border: 1px solid #eee;
            border-radius: 20px;
            min-height: 40px;
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-start;
            overflow-y: auto;
        }
        .cell.over {
            border: 2px dashed #000;
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: auto repeat(4, 1fr);
            }
            .grid > div:nth-child(n+6) {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="planner">
        <h1>WEEKLY LESSON PLAN (First Secondary)</h1>
        <div class="materials">
            <div class="material" draggable="true" style="background-color: #ffeeba;">Historyüó°Ô∏è</div>
            <div class="material" draggable="true" style="background-color: #d4edda;">Mathematicsüìê</div>
            <div class="material" draggable="true" style="background-color: #e2e3e5;">Englishüìñ</div>
            <div class="material" draggable="true" style="background-color: #cce5ff;">Sciencesüî¨</div>
            <div class="material" draggable="true" style="background-color: #f8d7da;">Philosophyü§î</div>
            <div class="material" draggable="true" style="background-color: #d1ecf1;">Arabicüïå</div>
            <div class="material" draggable="true" style="background-color: #e9ecef;">Germanüá©üá™</div>
        </div>
        <div class="grid">
            <div class="day">H/Day</div>
            <div class="subject" style="background-color: #ffeeba; font-size: 1.1rem; font-weight: bold; border-radius: 100px;">02-03</div>
            <div class="subject" style="background-color: #d4edda; font-size: 1.1rem; font-weight: bold; border-radius: 100px;">03-04</div>
            <div class="subject" style="background-color: #e2e3e5; font-size: 1.1rem; font-weight: bold; border-radius: 100px;">04-05</div>
            <div class="subject" style="background-color: #cce5ff; font-size: 1.1rem; font-weight: bold; border-radius: 100px;">05-06</div>
            <div class="subject" style="background-color: #f8d7da; font-size: 1.1rem; font-weight: bold; border-radius: 100px;">06-07</div>
            <div class="subject" style="background-color: #d1ecf1; font-size: 1.1rem; font-weight: bold; border-radius: 100px;">07-08</div>
            <div class="subject" style="background-color: #e9ecef; font-size: 1.1rem; font-weight: bold; border-radius: 100px;">08-09</div>
            <div class="day">SAT</div>
            <div class="cell" data-day="saturday"></div>
            <div class="cell" data-day="saturday"></div>
            <div class="cell" data-day="saturday"></div>
            <div class="cell" data-day="saturday"></div>
            <div class="cell" data-day="saturday"></div>
            <div class="cell" data-day="saturday"></div>
            <div class="cell" data-day="saturday"></div>
            <div class="day">SUN</div>
            <div class="cell" data-day="sunday"></div>
            <div class="cell" data-day="sunday"></div>
            <div class="cell" data-day="sunday"></div>
            <div class="cell" data-day="sunday"></div>
            <div class="cell" data-day="sunday"></div>
            <div class="cell" data-day="sunday"></div>
            <div class="cell" data-day="sunday"></div>
            <div class="day">MON</div>
            <div class="cell" data-day="monday"></div>
            <div class="cell" data-day="monday"></div>
            <div class="cell" data-day="monday"></div>
            <div class="cell" data-day="monday"></div>
            <div class="cell" data-day="monday"></div>
            <div class="cell" data-day="monday"></div>
            <div class="cell" data-day="monday"></div>
            <div class="day">TUE</div>
            <div class="cell" data-day="tuesday"></div>
            <div class="cell" data-day="tuesday"></div>
            <div class="cell" data-day="tuesday"></div>
            <div class="cell" data-day="tuesday"></div>
            <div class="cell" data-day="tuesday"></div>
            <div class="cell" data-day="tuesday"></div>
            <div class="cell" data-day="tuesday"></div>
            <div class="day">WED</div>
            <div class="cell" data-day="wednesday"></div>
            <div class="cell" data-day="wednesday"></div>
            <div class="cell" data-day="wednesday"></div>
            <div class="cell" data-day="wednesday"></div>
            <div class="cell" data-day="wednesday"></div>
            <div class="cell" data-day="wednesday"></div>
            <div class="cell" data-day="wednesday"></div>
            <div class="day">THU</div>
            <div class="cell" data-day="thursday"></div>
            <div class="cell" data-day="thursday"></div>
            <div class="cell" data-day="thursday"></div>
            <div class="cell" data-day="thursday"></div>
            <div class="cell" data-day="thursday"></div>
            <div class="cell" data-day="thursday"></div>
            <div class="cell" data-day="thursday"></div>
            <div class="day">FRI</div>
            <div class="cell" data-day="friday"></div>
            <div class="cell" data-day="friday"></div>
            <div class="cell" data-day="friday"></div>
            <div class="cell" data-day="friday"></div>
            <div class="cell" data-day="friday"></div>
            <div class="cell" data-day="friday"></div>
            <div class="cell" data-day="friday"></div>
        </div>
    </div>

    <script>
        const materials = document.querySelectorAll('.material');
        const cells = document.querySelectorAll('.cell');

        let draggedItem = null;
        let touchTimer = null;

        function isTouchDevice() {
            return 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;
        }

        if (isTouchDevice()) {
            materials.forEach(material => {
                material.addEventListener('touchstart', touchStart);
                material.addEventListener('touchend', touchEnd);
                material.addEventListener('touchmove', touchMove);
            });

            cells.forEach(cell => {
                cell.addEventListener('touchstart', cellTouchStart);
                cell.addEventListener('touchend', cellTouchEnd);
            });
        } else {
            materials.forEach(material => {
                material.addEventListener('dragstart', dragStart);
                material.addEventListener('dragend', dragEnd);
            });

            cells.forEach(cell => {
                cell.addEventListener('dragover', dragOver);
                cell.addEventListener('dragenter', dragEnter);
                cell.addEventListener('dragleave', dragLeave);
                cell.addEventListener('drop', drop);
            });
        }

        function touchStart(e) {
            draggedItem = this.cloneNode(true);
            draggedItem.style.position = 'absolute';
            draggedItem.style.opacity = '0.8';
            document.body.appendChild(draggedItem);

            touchTimer = setTimeout(() => {
                this.style.opacity = '0.5';
            }, 100);

            updateDraggedItemPosition(e.touches[0].clientX, e.touches[0].clientY);
        }

        function touchMove(e) {
            e.preventDefault();
            if (draggedItem) {
                updateDraggedItemPosition(e.touches[0].clientX, e.touches[0].clientY);
            }
        }

        function touchEnd(e) {
            clearTimeout(touchTimer);
            if (draggedItem) {
                const cellBelow = document.elementFromPoint(e.changedTouches[0].clientX, e.changedTouches[0].clientY);
                if (cellBelow && cellBelow.classList.contains('cell')) {
                    const newMaterial = createMaterialElement(draggedItem.outerHTML);
                    cellBelow.appendChild(newMaterial);
                }
                document.body.removeChild(draggedItem);
                draggedItem = null;
                this.style.opacity = '1';
                saveData();
            }
        }

        function updateDraggedItemPosition(x, y) {
            draggedItem.style.left = x - draggedItem.offsetWidth / 2 + 'px';
            draggedItem.style.top = y - draggedItem.offsetHeight / 2 + 'px';
        }

        function cellTouchStart(e) {
            touchTimer = setTimeout(() => {
                const materialToDelete = e.target.closest('.material');
                if (materialToDelete) {
                    materialToDelete.remove();
                    saveData();
                }
            }, 500);
        }

        function cellTouchEnd() {
            clearTimeout(touchTimer);
        }

        function dragStart(e) {
            e.dataTransfer.setData('text/html', this.outerHTML);
            this.style.opacity = '0.5';
        }

        function dragEnd() {
            this.style.opacity = '1';
        }

        function dragOver(e) {
            e.preventDefault();
        }

        function dragEnter(e) {
            e.preventDefault();
            this.classList.add('over');
        }

        function dragLeave() {
            this.classList.remove('over');
        }

        function drop(e) {
            e.preventDefault();
            const html = e.dataTransfer.getData('text/html');
            const newMaterial = createMaterialElement(html);
            this.appendChild(newMaterial);
            this.classList.remove('over');
            saveData();
        }

        function createMaterialElement(html) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            const newMaterial = tempDiv.firstChild;
            
            const deleteBtn = document.createElement('button');
            deleteBtn.textContent = '√ó';
            deleteBtn.classList.add('delete-btn');
            deleteBtn.addEventListener('click', function() {
                newMaterial.remove();
                saveData();
            });
            newMaterial.appendChild(deleteBtn);

            if (isTouchDevice()) {
                newMaterial.addEventListener('touchstart', touchStart);
                newMaterial.addEventListener('touchend', touchEnd);
                newMaterial.addEventListener('touchmove', touchMove);
            } else {
                newMaterial.addEventListener('dragstart', dragStart);
                newMaterial.addEventListener('dragend', dragEnd);
            }

            return newMaterial;
        }

        function saveData() {
            const plannerData = {
                cells: Array.from(cells).map(cell => cell.innerHTML)
            };
            localStorage.setItem('weeklyPlannerData', JSON.stringify(plannerData));
        }

        function loadSavedData() {
            const savedData = localStorage.getItem('weeklyPlannerData');
            if (savedData) {
                const plannerData = JSON.parse(savedData);
                
                cells.forEach((cell, index) => {
                    cell.innerHTML = plannerData.cells[index] || '';
                    cell.querySelectorAll('.material').forEach(material => {
                        if (isTouchDevice()) {
                            material.addEventListener('touchstart', touchStart);
                            material.addEventListener('touchend', touchEnd);
                            material.addEventListener('touchmove', touchMove);
                        } else {
                            material.addEventListener('dragstart', dragStart);
                            material.addEventListener('dragend', dragEnd);
                        }
                        material.querySelector('.delete-btn').addEventListener('click', function() {
                            material.remove();
                            saveData();
                        });
                    });
                });
            }
        }

        window.addEventListener('load', loadSavedData);
    </script>
</body>
</html>